<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Stellar Stories</title>

<!-- P5.js for the game -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js"></script>

<style>
:root{
  --light-bg: linear-gradient(to bottom,#87cefa,#ffffff);
  --dark-bg: radial-gradient(circle at bottom,#00111f,#000000);
  --light-text:#000;
  --dark-text:#fff;
  --accent-light:#ff8c00;
  --accent-dark:#7fffd4;
}

body{
  margin:0;
  font-family:Arial, sans-serif;
  background:var(--dark-bg);
  color:var(--dark-text);
  transition:background .5s,color .5s;
  overflow-x:hidden;
  position:relative;
}
body.light{ background:var(--light-bg); color:var(--light-text); }

header{ text-align:center; padding:20px; position:relative; }
header h1{ margin:0; }
header p{ margin:5px 0 10px; }
.theme-toggle{ position:absolute; top:15px; right:15px; font-size:2rem; background:none; border:none; cursor:pointer; }

nav{ display:flex; justify-content:center; padding:10px; background:#111; }
nav a{ color:var(--accent-dark); margin:0 15px; text-decoration:none; }
body.light nav a{ color:var(--accent-light); }

section{ max-width:1000px; margin:auto; padding:30px 15px; text-align:center; }
h2{ margin-bottom:15px; }

/* stars dark mode */
.stars{ display:block; position:fixed; width:100%; height:100%; background:transparent; pointer-events:none; z-index:0; }
body.light .stars{ display:none; }
.stars::before{
  content:''; position:absolute; width:200%; height:200%;
  background:transparent url('https://www.transparenttextures.com/patterns/stardust.png') repeat;
  animation:moveStars 60s linear infinite; opacity:.3;
}
@keyframes moveStars{ from{transform:translateY(0)} to{transform:translateY(-100%)} }

/* clouds light mode */
.clouds{ display:none; position:fixed; width:100%; height:100%; pointer-events:none; z-index:0;
  background:url('https://www.transparenttextures.com/patterns/clouds.png') repeat;
  animation:moveClouds 120s linear infinite; opacity:.2;
}
body.light .clouds{ display:block; }
@keyframes moveClouds{ from{background-position:0 0} to{background-position:1000px 0} }

/* video player */
.video-wrapper{
  position: relative;
  width: 100%;
  max-width: 800px;
  margin: auto;
  background: #000;
  border-radius: 10px;
  overflow: hidden;
  aspect-ratio: 16/9;
}
video{
  width:100%;
  height:100%;
  display:block;
  object-fit:contain;
  background:#000;
}
.video-controls{
  position:absolute;
  bottom:10px;
  left:0;
  right:0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:6px 10px;
  color:#fff;
  font-size:14px;
  background: linear-gradient(to top, rgba(0,0,0,0.35), transparent);
  transition:opacity .2s;
}
.video-controls button{
  background:rgba(0,0,0,0.6);
  border:none;
  color:#fff;
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}
.video-controls input[type="range"]{ flex:1; margin:0 10px; }

/* ACTORS */
.dependence{ display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-top:30px; }
.actor{ flex:1 1 200px; padding:15px; background:rgba(255,255,255,0.05); border-radius:10px; transition:transform .3s,background .3s; cursor:pointer; }
.actor:hover{ transform:scale(1.05); background:rgba(255,255,255,0.1); }
body.light .actor{ background:rgba(0,0,0,0.05); }
.actor h3{ margin-bottom:10px; }

/* COMIC OVERLAY */
.comic-overlay{
  display:none;
  position:fixed; top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.95);
  z-index:9999;
  justify-content:center; align-items:center; flex-direction:column;
}
.comic-container{
  position:relative;
  width:90vw;
  height:90vh;
  max-width:100%;
  max-height:100%;
  overflow:hidden;
  border-radius:10px;
  background:#000;
  display:flex;
  align-items:center;
  justify-content:center;
}
.comic-slides{
  display:flex;
  transition:transform .45s ease;
  will-change:transform;
  width:100%;
  height:100%;
}
.comic-slide{
  min-width:100%;
  min-height:100%;
  box-sizing:border-box;
  display:flex;
  align-items:center;
  justify-content:center;
}
.comic-slide img{
  width:100%;
  height:100%;
  object-fit:contain;
  border-radius:10px;
}
.comic-counter{ position:absolute; top:12px; right:16px; color:#fff; background:rgba(0,0,0,0.5); padding:6px 10px; border-radius:20px; font-size:14px; z-index:20; }
.close-comic{ position:absolute; top:12px; left:16px; background:rgba(255,255,255,0.12); color:#fff; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; z-index:20; }
.comic-nav{ margin-top:14px; display:flex; justify-content:space-between; width:140px; }
.comic-nav button{ background:rgba(255,255,255,0.12); border:none; color:#fff; padding:8px 12px; border-radius:6px; cursor:pointer; }

/* GAME CONTAINER */
#game-container {
  width: 100%;
  max-width: 800px;
  aspect-ratio: 3/2;
  border: 3px solid #0f0;
  overflow: hidden;
  margin: 40px auto;
  position: relative;
}
canvas {
  width: 100% !important;
  height: 100% !important;
  display: block;
}
</style>
</head>

<body>
<div class="stars"></div>
<div class="clouds"></div>

<header>
  <h1>Interactive Stellar Stories</h1>
  <p>Explore the space weather with us</p>
  <button class="theme-toggle" id="themeToggle">🌙</button>
</header>

<nav>
  <a href="#weather">Space Weather</a>
  <a href="#story">Interactive Story</a>
  <a href="#dependence">Space Weather Impact</a>
  <a href="#game">Game</a>
</nav>

<section id="intro">
  <h2>Welcome to the World of Space Weather</h2>
  <p>Solar weather refers to the conditions in space caused by the Sun’s activity.
It includes solar flares, sunspots, coronal mass ejections, and solar wind.
These events release energy and charged particles into space.
Solar weather can affect satellites, astronauts, power grids, and communication on Earth.</p>
<p>SOLAR FLARE: A solar flare is a sudden burst of energy and light from the Sun’s surface.
It releases intense radiation that can affect satellites and radio communications on Earth.</p>
</section>

<section id="story">
  <h2>Interactive Story</h2>
  <p>Watch the animation below to learn more about solar flare.</p>

  <div class="video-wrapper">
    <video id="spaceVideo" preload="metadata" playsinline>
      <source src="animation1.mp4" type="video/mp4">
      Your browser does not support HTML5 video.
    </video>

    <div class="video-controls" id="videoControls">
      <button id="playPause">▶</button>
      <input id="seekBar" type="range" min="0" max="100" step="0.1" value="0">
      <span id="timeDisplay">0:00 / 0:00</span>
    </div>
  </div>
</section>

<section id="dependence">
  <h2>Space Weather Impacts on Different People</h2>
  <div class="dependence">
    <div class="actor" id="farmers"><h3>Farmers</h3><p>GPS signals for tractors and irrigation systems can be disrupted by solar storms.</p></div>
    <div class="actor" id="pilots"><h3>Pilots</h3><p>High-latitude flights may be rerouted to avoid high radiation exposure during solar events.</p></div>
    <div class="actor" id="astronauts"><h3>Astronauts</h3><p>Solar flares can expose astronauts to harmful radiation, requiring safe havens.</p></div>
    <div class="actor" id="powergrid"><h3>Power Grid Operators</h3><p>Geomagnetic storms can induce currents in power lines and damage transformers.</p></div>
    <div class="actor" id="generalpublic"><h3>General Public</h3><p>Communications, GPS, and even internet connectivity can be impacted globally.</p></div>
  </div>
</section>

<section id="game">
  <h2>Catch the Solar Flares </h2>
   <p style="max-width:600px; margin:auto; margin-bottom:20px;">
    Try to catch the light solar flares 🔥 and avoid the intense solar flares ⚡. 
    Your goal is to collect 30 light flares without getting hit by 5 intense flares.
    You'll get to know what's the difference in both.
  </p>
  <div id="game-container"></div>
</section>

<!-- COMIC OVERLAY -->
<div class="comic-overlay" id="comicOverlay" aria-hidden="true">
  <div class="comic-container" role="dialog" aria-modal="true">
    <button class="close-comic" id="closeComicBtn" aria-label="Close">✖</button>
    <div class="comic-counter" id="comicCounter">1 / 4</div>
    <div class="comic-slides" id="comicSlides"></div>
  </div>

  <div class="comic-nav" id="comicNav">
    <button id="prevSlide">⟨</button>
    <button id="nextSlide">⟩</button>
  </div>
</div>

<script>
/* THEME TOGGLE */
const themeToggle=document.getElementById('themeToggle');
themeToggle.addEventListener('click',()=>{ document.body.classList.toggle('light'); themeToggle.textContent=document.body.classList.contains('light')?'☀':'🌙'; });

/* VIDEO PLAYER */
const video = document.getElementById("spaceVideo");
const playPause = document.getElementById("playPause");
const seekBar = document.getElementById("seekBar");
const timeDisplay = document.getElementById("timeDisplay");
function formatTime(seconds){ if (!isFinite(seconds)) return '0:00'; const m=Math.floor(seconds/60); const s=Math.floor(seconds%60); return `${m}:${s<10?'0'+s:s}`; }
playPause.addEventListener('click', ()=>{ if(video.paused||video.ended){ video.play(); playPause.textContent='⏸'; } else{ video.pause(); playPause.textContent='▶'; } });
video.addEventListener('loadedmetadata', ()=>{ timeDisplay.textContent=`${formatTime(0)} / ${formatTime(video.duration)}`; });
video.addEventListener('timeupdate', ()=>{ if(video.duration){ const pct=(video.currentTime/video.duration)*100; seekBar.value=pct; timeDisplay.textContent=`${formatTime(video.currentTime)} / ${formatTime(video.duration)}`; } });
seekBar.addEventListener('input', ()=>{ if(video.duration){ video.currentTime=(seekBar.value/100)*video.duration; } });

/* COMIC VIEWER */
const comics = {
  farmers: ['farmer1.jpg','farmer2.jpg','farmer3.jpg','farmer4.jpg'],
  pilots: ['pilot1.jpg','pilot2.jpg','pilot3.jpg','pilot4.jpg'],
  astronauts: ['astronaut1.jpg','astronaut2.jpg','astronaut3.jpg','astronaut4.jpg'],
  powergrid: ['grid1.jpg','grid2.jpg','grid3.jpg','grid4.jpg'],
  generalpublic: ['public1.jpg','public2.jpg','public3.jpg','public4.jpg']
};
const overlay=document.getElementById('comicOverlay');
const slidesContainer=document.getElementById('comicSlides');
const counterEl=document.getElementById('comicCounter');
const prevBtn=document.getElementById('prevSlide');
const nextBtn=document.getElementById('nextSlide');
const closeBtn=document.getElementById('closeComicBtn');
let currentSlides=[],currentIndex=0;
function populateSlides(images){ slidesContainer.innerHTML=''; images.forEach(src=>{ const slide=document.createElement('div'); slide.className='comic-slide'; const img=document.createElement('img'); img.src=src; img.alt='Comic page'; slide.appendChild(img); slidesContainer.appendChild(slide); }); slidesContainer.style.transform='translateX(0%)'; }
function openComic(actorKey){ if(!comics[actorKey]) return; currentSlides=comics[actorKey].slice(); currentIndex=0; populateSlides(currentSlides); counterEl.textContent=`${currentIndex+1} / ${currentSlides.length}`; overlay.style.display='flex'; overlay.setAttribute('aria-hidden','false'); slidesContainer.style.transform='translateX(0%)'; }
function closeComic(){ overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); slidesContainer.innerHTML=''; currentSlides=[]; currentIndex=0; }
function showIndex(i){ if(currentSlides.length===0) return; if(i<0)i=currentSlides.length-1; if(i>=currentSlides.length)i=0; currentIndex=i; slidesContainer.style.transform=`translateX(${-currentIndex*100}%)`; counterEl.textContent=`${currentIndex+1} / ${currentSlides.length}`; }
prevBtn.addEventListener('click', ()=>showIndex(currentIndex-1));
nextBtn.addEventListener('click', ()=>showIndex(currentIndex+1));
closeBtn.addEventListener('click', closeComic);
['farmers','pilots','astronauts','powergrid','generalpublic'].forEach(id=>document.getElementById(id).addEventListener('click', ()=>openComic(id)));

/* --- RAW GAME CODE STARTS HERE --- */
let basketX, basketWidth, basketHeight;
let flares = [];
let lightScore = 0, intenseScore = 0;
let gameState = "start";
let dragging = false, movingLeft = false, movingRight = false;
let startTime, elapsedTime = 0;
let sunImg, earthImg, auroraImg, gameOverImg;
let lightSound, intenseSound;

function preload() {
  auroraImg = loadImage("aurora.jpg");
  sunImg = loadImage("sun12.png");
  earthImg = loadImage("earth1.png");
  gameOverImg = loadImage("gps.jpg");

  lightSound = loadSound("coin.mp3");
  intenseSound = loadSound("error.mp3");
}

function setup() {
  let container = document.getElementById("game-container");
  let w = container.clientWidth;
  let h = container.clientHeight;
  let cnv = createCanvas(w, h);
  cnv.parent("game-container");
  scaleGameElements();
}

function windowResized() {
  let container = document.getElementById("game-container");
  resizeCanvas(container.clientWidth, container.clientHeight);
  scaleGameElements();
}

function scaleGameElements() {
  basketWidth = width * 0.15;
  basketHeight = height * 0.08;
  basketX = width / 2;
}

function draw() {
  background(20, 20, 50);

  if (gameState === "start") return drawStartScreen();
  if (gameState === "giftOverlay") return drawGiftOverlay();
  if (gameState === "aurora") return drawAuroraScreen();
  if (gameState === "gameover") return drawGameOverScreen();
  drawPlayingGame();
}

function drawStartScreen() {
  textAlign(CENTER, CENTER);
  fill(255);
  textSize(width * 0.035);
  text("Catch the light solar flares 🔥, Avoid the intense solar flares ⚡", width/2, height/2 - 40);
  drawButton(width/2 - 100, height/2, 200, 40, "Start Game ▶");
}

function drawGiftOverlay() {
  fill(255);
  textAlign(CENTER, CENTER);
  textSize(width * 0.035);
  text("You have collected 30 light flares!", width/2, height/2 - 60);
  drawButton(width/2 - 100, height/2, 200, 40, "Here's your gift 🎁", true);
}

function drawAuroraScreen() {
  imageMode(CORNER);
  image(auroraImg, 0, 0, width, height);
  fill(255);
  textAlign(CENTER, CENTER);
  textSize(width * 0.04);
  text("Congrats! You have saved the EARTH!!", width/2, height/2 - 40);
  drawButton(width/2 - 100, height/2 + 60, 200, 40, "Restart Game 🔄", true);
}

function drawGameOverScreen() {
  imageMode(CORNER);
  image(gameOverImg, 0, 0, width, height);
  fill(255);
  textAlign(CENTER, CENTER);
  textSize(width * 0.07);
  text("GAME OVER", width/2, height/2 - 120);
  textSize(width * 0.04);
  text("A GPS disruption has occured in the EARTH", width/2, height/2 - 40);
  drawButton(width/2 - 100, height/2 + 40, 200, 40, "Restart Game 🔄", true);
}

function drawPlayingGame() {
  elapsedTime = floor((millis() - startTime) / 1000);
  let remainingTime = max(30 - elapsedTime, 0);
  if (remainingTime <= 0) gameState = "gameover";

  imageMode(CENTER);
  image(sunImg, width / 2, height * 0.15, width * 0.25, height * 0.2);

  fill(255);
  textAlign(CENTER);
  textSize(width * 0.04);
  text("Time: " + remainingTime + "s", width/2, height * 0.25);

  if (dragging) basketX = mouseX - basketWidth / 2;
  if (movingLeft) basketX -= 5;
  if (movingRight) basketX += 5;
  basketX = constrain(basketX, 0, width - basketWidth);

  imageMode(CORNER);
  image(earthImg, basketX, height - basketHeight - 20, basketWidth, basketHeight);

  textAlign(CENTER, CENTER);
  let flareSize = width * 0.06;
  textSize(flareSize);

  for (let i = flares.length - 1; i >= 0; i--) {
    flares[i].y += flares[i].good ? 2 : 2.5;
    text(flares[i].good ? "🔥" : "⚡", flares[i].x, flares[i].y);

    if (flares[i].y + flareSize/2 >= height - basketHeight - 10 &&
        flares[i].y - flareSize/2 <= height &&
        flares[i].x >= basketX &&
        flares[i].x <= basketX + basketWidth) {

        if (flares[i].good) lightSound.play();
        else intenseSound.play();

        if (flares[i].good) {
            lightScore++;
            if (lightScore >= 30) gameState = "giftOverlay";
        } else {
            intenseScore++;
            if (intenseScore >= 5) gameState = "gameover";
        }

        flares.splice(i, 1);
    } else if (flares[i].y - flareSize/2 > height) {
        flares.splice(i, 1);
    }
  }

  if (frameCount % 30 === 0) {
    let isGood = random() > 0.3;
    let xPos = isGood ? random(width/2 - width/4, width/2 + width/4) : random(width);
    flares.push({ x: xPos, y: height * 0.15, good: isGood });
  }

  fill(255);
  textAlign(LEFT); textSize(width * 0.035);
  text("Light 🔥: " + lightScore, 20, 30);
  textAlign(RIGHT);
  text("Intense ⚡: " + intenseScore, width - 20, 30);
}

function drawButton(x, y, w, h, label, shrink=false) {
  fill(0, 200, 100);
  rect(x, y, w, h, 10);
  fill(255);
  textAlign(CENTER, CENTER);
  textSize(shrink ? width * 0.032 : width * 0.04);
  text(label, x + w/2, y + h/2);
}

function mousePressed() {
  if (gameState === "start" &&
      mouseX > width/2 - 100 && mouseX < width/2 + 100 &&
      mouseY > height/2 && mouseY < height/2 + 40) {
    gameState = "playing";
    startTime = millis();
  } else if (gameState === "giftOverlay" &&
             mouseX > width/2 - 100 && mouseX < width/2 + 100 &&
             mouseY > height/2 && mouseY < height/2 + 40) {
    gameState = "aurora";
  } else if (gameState === "aurora" &&
             mouseX > width/2 - 100 && mouseX < width/2 + 100 &&
             mouseY > height/2 + 60 && mouseY < height/2 + 100) {
    restartGame();
  } else if (gameState === "gameover" &&
             mouseX > width/2 - 100 && mouseX < width/2 + 100 &&
             mouseY > height/2 + 40 && mouseY < height/2 + 80) {
    restartGame();
  } else if (gameState === "playing" &&
             mouseX > basketX && mouseX < basketX + basketWidth &&
             mouseY > height - basketHeight - 20 && mouseY < height - 20) {
    dragging = true;
  }
}

function mouseReleased() { dragging = false; }
function keyPressed() { if(keyCode===LEFT_ARROW) movingLeft=true; if(keyCode===RIGHT_ARROW) movingRight=true; }
function keyReleased() { if(keyCode===LEFT_ARROW) movingLeft=false; if(keyCode===RIGHT_ARROW) movingRight=false; }

function restartGame() {
  gameState = "start";
  basketX = width/2;
  flares = [];
  lightScore = 0;
  intenseScore = 0;
  elapsedTime = 0;
}
</script>


</body>
</html>




